<!-- src/app/technician/dashboard.component.html -->
<div class="dashboard-root">
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="brand">
      <div class="logo">
        <span class="logo-ico">ðŸ› </span>
        <span class="logo-text">Site Smart</span>
      </div>
    </div>
  

    <nav class="nav">
      <a class="nav-item active"><span class="nav-ico">â–¦</span><span>Dashboard</span></a>

      <!-- <a class="nav-item" [class.disabled]="isPending()" (click)="openJobsModal()"><span class="nav-ico">ðŸ§°</span><span>Jobs</span></a>-->
      <a class="nav-item"  (click)="openJobsModal()"><span class="nav-ico">ðŸ§°</span><span>Jobs</span></a>

      <a class="nav-item" (click)="openWalletModal()"><span class="nav-ico">ðŸ’¼</span><span>Wallet</span></a>

      <a class="nav-item" (click)="openProfileModal()"><span class="nav-ico">ðŸ‘¤</span><span>Profile</span></a>

      <a class="nav-item" (click)="openContactModal()"><span class="nav-ico">ðŸ’¬</span><span>Contact & About</span></a>

    </nav>
<!--Verify account document --> 
    <div class="verify-cta" style="margin:18px 0;">
    <button class="btn-verify" (click)="openVerifyModal()">
    ðŸ”’ Verify Account
    <div style="font-size:12px; margin-top:6px;">Upload ID & certificates to get verified</div>
  </button>
  </div>

    <div class="side-footer">
      <div class="profile-row">
        <img class="avatar" [src]="profileImage || '/assets/avatar.png'" alt="avatar" />
        <div class="profile-text">
          <div class="name">{{ profileName }}</div>
          <div class="role">Technician</div>
        </div>
      </div>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main-area">
    <div class="alert-banner" *ngIf="verificationStatus !== 'Verified'">
  Your account is under verification. Please upload your document to get full access.
</div>

    <header class="topbar">
      <div>
        <h1 class="welcome-title">Welcome, <span class="accent">{{ profileName || 'John' }}</span>!</h1>
        <div class="subtitle">Here's your performance overview for today.</div>
      </div>
    </header>

    <!-- STATS -->
    <section class="stats-grid">
      <div class="stat-card">
        <div class="stat-head">Earnings (This Month)</div>
        <div class="stat-value">\${{ stats.totalRevenue | number:'1.0-0' }}</div>
        <div class="stat-delta positive">â–² {{ stats.revenueChange }}%</div>
      </div>

      <div class="stat-card">
        <div class="stat-head">Jobs Completed</div>
        <div class="stat-value">{{ stats.jobsCompleted }}</div>
        <div class="stat-delta positive">â–² {{ stats.jobsChange }}%</div>
      </div>

      <div class="stat-card">
        <div class="stat-head">Current Rating</div>
        <div class="stat-value">{{ stats.currentRating }}/5</div>
        <div class="stat-delta negative">â–¼ 0.1</div>
      </div>

      <div class="stat-card">
        <div class="stat-head">Wallet Balance</div>
        <div class="stat-value">\${{ stats.wallet | number:'1.2-2' }}</div>
        <div class="stat-delta positive">â–² 15%</div>
      </div>
    </section>

    <!-- CONTENT -->
    <section class="content-grid">
      <!-- LEFT: requests -->
      <div class="col-left">
        <div class="card requests">
          <div class="card-head">
            <h3>New Job Requests</h3>
            <div class="muted">You have {{ newJobs.length }} new requests</div>
          </div>

          <div class="requests-list">
            <div class="request-row" *ngFor="let j of newJobs">
              <div class="request-left">
                <div class="request-ico">ðŸ”§</div>
                <div class="request-body">
                  <div class="req-title">{{ j.title }}</div>
                  <div class="req-sub">{{ j.rateText }} â€¢ {{ j.address }}</div>
                </div>
              </div>

              <div class="request-actions">
                <button class="btn btn-decline" (click)="decline(j.bookingID)">Decline</button>
                <button class="btn btn-accept" 
                 (click)="acceptJob(j.bookingID)" 
                [disabled]="isPending()">
                 Accept
                </button>

              </div>
            </div>

            <div *ngIf="newJobs.length === 0" class="empty">No new requests</div>
          </div>
        </div>
      </div>

      <!-- RIGHT: current + earnings -->
      <aside class="col-right">
        <div class="card current" *ngIf="currentJob">
          <div class="card-head">
            <h3>Current Job</h3>
          </div>

          <div class="current-body">
            <div class="current-title">{{ currentJob.title }}</div>
            <div class="current-address">{{ currentJob.address }}</div>

            <div class="progress-wrap">
              <div class="progress-label">In Progress</div>
              <div class="progress-bar">
                <div class="progress-fill" [style.width.%]="currentJob.progress"></div>
              </div>
              <div class="progress-percent">{{ currentJob.progress }}%</div>
            </div>
          </div>
        </div>

        <div class="card earnings">
          <div class="card-head">
            <h3>Weekly Earnings</h3>
          </div>

          <div class="earn-body">
            <div class="earn-value">\${{ weekly.total | number:'1.0-0' }}</div>
            <div class="earn-change positive">+{{ weekly.change }}% vs last week</div>

            <div class="mini-spark">
              <div class="bar" *ngFor="let b of weekly.bars" [style.height.%]="b"></div>
            </div>
          </div>
        </div>
      </aside>
    </section>
<!-- Verification Modal (compact centered container) -->
<div class="verify-modal-backdrop" *ngIf="showVerifyModal" (click)="closeVerifyModal()">
  <div class="verify-modal" (click)="$event.stopPropagation()">
    <div class="verify-modal-header">
      <h2>Technician Verification</h2>
      <button class="close-btn" (click)="closeVerifyModal()">âœ–</button>
    </div>

    <div class="verify-modal-body">
      <!-- Reuse the verify component inside modal -->
      <app-technician-verify-doc></app-technician-verify-doc>
    </div>
  </div>
</div>

<!-- Contact & About Modal -->
<div class="verify-modal-backdrop" *ngIf="showContactModal" (click)="closeContactModal()">
  <div class="verify-modal" (click)="$event.stopPropagation()">

    <div class="verify-modal-header">
      <h2>Contact & About</h2>
      <button class="close-btn" (click)="closeContactModal()">âœ–</button>
    </div>

    <div class="verify-modal-body">
      <app-contact-about (saved)="closeContactModal()"></app-contact-about>
    </div>

  </div>
</div>

<!-- Profile Modal -->
<div class="verify-modal-backdrop" *ngIf="showProfileModal" (click)="closeProfileModal()">
  <div class="verify-modal" (click)="$event.stopPropagation()">
    <div class="verify-modal-header">
      <h2>Profile</h2>
      <button class="close-btn" (click)="closeProfileModal()">âœ–</button>
    </div>

    <div class="verify-modal-body">
      <app-profile (saved)="closeProfileModal()"></app-profile>
    </div>
  </div>
</div>

<!-- Wallet modal -->
<div class="verify-modal-backdrop" *ngIf="showWalletModal" (click)="closeWalletModal()">
  <div class="verify-modal" (click)="$event.stopPropagation()">
    <div class="verify-modal-header">
      <h2>Wallet</h2>
      <button class="close-btn" (click)="closeWalletModal()">âœ–</button>
    </div>
    <div class="verify-modal-body">
      <app-wallet></app-wallet>
    </div>
  </div>
</div>


<div class="verify-modal-backdrop" *ngIf="showJobsModal" (click)="closeJobsModal()">
  <div class="verify-modal" (click)="$event.stopPropagation()">
    <div class="verify-modal-header">
      <h2>Jobs</h2>
      <button class="close-btn" (click)="closeJobsModal()">âœ–</button>
    </div>
    <div class="verify-modal-body">
      <app-jobs></app-jobs>
    </div>
  </div>
</div>

  </main>
</div>
